const mongoose = require("mongoose");
const modelName = "game_markets";

/**
 * @type {Model.GameMarketModel}
 */
const Schema = new mongoose.Schema({
  gameId: Number,
  gameName: String,
  markets: [],
  botEnabled: {
    type: Boolean,
    default: true,
  },
  botMaxBet: {
    type: Number,
    default: 0,
  },
});

/**
 * @type {Model.GameMarketRepository}
 */
const gameMarketRepository = mongoose.models[modelName] ?? mongoose.model(modelName, Schema);

gameMarketRepository.getByGameId = function (gameId) {
  return gameMarketRepository
    .findOne({ gameId: gameId }, null, { sort: { id: -1 } })
    .lean()
    .exec();
};

gameMarketRepository.getAll = () => gameMarketRepository.find({}).lean().exec();

module.exports = gameMarketRepository;
