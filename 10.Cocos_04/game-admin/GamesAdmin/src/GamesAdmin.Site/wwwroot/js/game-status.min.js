class GameStatus{gameName = ''

    checkAll(){var n=$("#status-all").prop("checked"),t=$("#status-tbl");t.find(".game-status-chk").prop({checked:n})}uncheckAll(n){$(n).is(":checked")||$("#status-all").prop({checked:!1})}enable(){var n=this.getCheckedGames(),t,i;n.message.length>0?(t="ENABLE games:\n"+n.message+"Are you sure?",i=$("#reload").is(":checked"),confirm(t)&&$.ajax({method:"POST",url:"/status/enable",data:{games:n.games,reload:i}}).done(function(n){n&&(window.location.href="/status")})):alert("You should choose at least one game.")}disable(){var n=this.getCheckedGames(),t,i;n.message.length>0?(t="DISABLE games:\n"+n.message+"Are you sure?",i=$("#reload").is(":checked"),confirm(t)&&$.ajax({method:"POST",url:"/status/disable",data:{games:n.games,reload:i}}).done(function(n){n&&(window.location.href="/status")})):alert("You should choose at least one game.")}reload(){confirm("Are you sure you want all users to RELOAD?")&&$.ajax({method:"POST",url:"/status/reload"}).done(function(n){n&&alert("Users reloaded!")})}getCheckedGames(){for(var u,f,e=$("#status-tbl"),t=e.find(".game-status-chk"),i="",r=[],n=0;n<t.length;n++)$(t[n]).is(":checked")&&(r.push($(t[n]).val()),u=$(t[n]).parent(),f=u.find(".game-display-name"),i+="<li> "+f.val()+"<\/li>");return{games:r,message:i}}showGameForm(n,t){$.ajax({method:"GET",url:"/gamemarket/"+n}).done(function(n){n&&($("#gamedetails").html(n),$("#gameTitleName").html(t),$("#gameModal").modal("show"))})}showOddsForm(n,t){$.ajax({method:"GET",url:"/getodds/"+n}).done(function(n){n&&(console.log(n),$("#oddsDetail").html(n),$("#gameName").html(t),$("#oddsModal").modal("show"))})}updateBotCount(n){const t=$("#botRatioModal");var i=parseFloat($(n).parent().find(".ratio").val()),r=parseInt(t.find("#total_bots_field").val()),u=parseInt(i*r/100);$(n).parent().find(".bot-number").html(`${u} bot(s)`)}showBotRatioModal(n){const t=$("#botRatioModal");this.gameName=n;t.find("#failedMsg").hide();t.find("#successMsg").hide();$.ajax({method:"GET",url:"/botratio/"+n}).done(function(n){const i=n.botRatioItems;for(let r=0;r<24;r++){const u=t.find(`#bot_setting_${r}`);t.find("#total_bots").html(n.botCount);t.find("#total_bots_field").val(n.botCount);t.find("#modal_title").html(`<b>${n.displayName}</b> - Adjust bots by hour`);u.find(".time-gtm4").html(i[r].greenwichHour);u.find(".time-gtm7").html(i[r].asiaPacificHour);u.find(".ratio").val(i[r].botRatio);u.find(".utc-hour").val(i[r].utcHour);u.find(".bot-number").html(`${i[r].currentBot} bot(s)`);u.find("#validate_ratio").html("")}$("#botRatioModal").modal("show")})}updateBotRationItems(){const n=$("#botRatioModal"),t=n.find("#updateBotRatioBtn"),i=[];let r=!0;t.prop("disabled",!0);for(let u=0;u<24;u++){const f=n.find(`#bot_setting_${u}`),e=f.find(".ratio").val();e<0||e>100?(r=!1,t.prop("disabled",!1),f.find("#validate_ratio").html("Number range [0..100]")):f.find("#validate_ratio").html("");i.push({BotRatio:e,UtcHour:f.find(".utc-hour").val()})}r&&$.ajax({method:"POST",url:"/"+this.gameName,data:{BotRatioItems:i}}).done(function(i){i?n.find("#successMsg").show():n.find("#failedMsg").show();setTimeout(function(){t.prop("disabled",!1);n.modal("hide")},1e3)})}startMonitor(n){var t={method:"POST",body:JSON.stringify({userAgent:navigator.userAgent}),headers:{"Content-type":"application/json; charset=UTF-8"}};fetch("/jwt",t).then(n=>n.json()).then(()=>{window.open(`/game-admin/monitor.html?game=${n}&v=${(new Date).getTime()}`,"_blank","width=1020,height=765")})}submit(){$("#updateBtn").prop("disabled",!0);$("#failedMsg").hide();$.ajax({method:"POST",url:"/gamemarket",dataType:"json",data:$("#gameForm").serialize()}).done(function(n){n.success?($("#successMsg").show(),setTimeout(function(){$("#updateBtn").prop("disabled",!1);$("#gameModal").modal("hide");location.reload()},1e3)):($("#failedMsg").show(),$("#failedMsgContent").html(n.message),$("#updateBtn").prop("disabled",!1))})}updateOdds(){$("#failedMsg").hide();const i=$("#oddsForm").serializeArray(),n=i.filter(n=>n.name.endsWith(".Odds"));let t=!0;for(let i=0;i<n.length;i++)n[i].value===""&&(t=!1);t?($("#updateOddsBtn").prop("disabled",!0),$("#failedMsg").hide(),$.ajax({method:"PUT",url:"/updateodds",dataType:"json",data:$("#oddsForm").serialize()}).done(function(n){n.success?($("#successMsg").show(),setTimeout(function(){$("#updateOddsBtn").prop("disabled",!1);$("#oddsModal").modal("hide")},1e3)):($("#failedMsg").show(),$("#failedMsgContent").html(n.message),$("#updateOddsBtn").prop("disabled",!1))})):($("#failedMsg").show(),$("#failedMsgContent").html("Odds value is invalid"))}updateMessage(){var n=$("#textMessage").val(),t=$("#applyAllCheckbox").is(":checked"),i=$("#msgGameName").val(),r=t?"/status/update":"/status",u={name:i,disabledMessage:n};$("#updateMsgBtn").prop("disabled",!0);$.ajax({method:"POST",url:r,dataType:"json",data:u}).done(function(n){n?$("#updateMsgSuccess").show():$("#updateMsgFailed").show();setTimeout(function(){$("#updateMsgBtn").prop("disabled",!1);$("#updateMsgSuccess").hide();$("#updateMsgFailed").hide();$("#messageModal").modal("hide");location.reload()},1e3)})}showUpdateMessage(n,t,i){$("#textMessage").val(n);$("#msgGameName").val(t);$("#updateMsgGameName").html(i);$("#messageModal").modal("show")}submitReload(){const n=$("#reloadModal");n.find("#confirmBtn").prop("disabled",!0);$.ajax({method:"POST",url:"/status/reload"}).done(function(t){t?n.find("#updateMsgSuccess").show():n.find("#updateMsgFailed").show();setTimeout(function(){n.find("#confirmBtn").prop("disabled",!1);n.find("#updateMsgSuccess").hide();n.find("#updateMsgFailed").hide();n.modal("hide")},1e3)})}showReload(){const n=$("#reloadModal");n.find("#reloadContent").html("Are you sure you want all users to RELOAD?");n.modal("show")}showClearSession(){const n=$("#confirmModal");n.find("#confirmContent").html("Are you sure you want to clear all user sessions?");n.modal("show")}submitClearSession(){const n=$("#confirmModal");n.find("#confirmBtn").prop("disabled",!0);$.ajax({method:"POST",url:"/clearsessions"}).done(function(t){t?n.find("#updateMsgSuccess").show():n.find("#updateMsgFailed").show();setTimeout(function(){n.find("#confirmBtn").prop("disabled",!1);n.find("#updateMsgSuccess").hide();n.find("#updateMsgFailed").hide();n.modal("hide")},1e3)})}showEnableDisable(n){var i,u;const t=$("#enableDisableModal"),r=n?"enable":"disable";i=this.getCheckedGames();i.message.length>0?(u=`Are you sure you want to ${r.toLocaleUpperCase()} the following games<br /><ul>`+i.message+"<\/ul>",t.find("#enableDisableContent").html(u),t.find("#forceReloadLabel").html(`Force users to reload after ${r} game(s)`),t.find("#enableDisableFlag").val(n),t.modal("show")):this.showAlert("You should choose at least one game.")}submitEnableDisable(){const n=$("#enableDisableModal"),t=n.find("#enableDisableFlag").val(),i=t==="true"?"enable":"disable";var r=this.getCheckedGames(),u=n.find("#forceReloadCheckbox").is(":checked");n.find("#confirmBtn").prop("disabled",!0);$.ajax({method:"POST",url:`/status/${i}`,data:{games:r.games,reload:u}}).done(function(t){t?n.find("#updateMsgSuccess").show():n.find("#updateMsgFailed").show();setTimeout(function(){n.find("#confirmBtn").prop("disabled",!1);n.find("#updateMsgSuccess").hide();n.find("#updateMsgFailed").hide();n.modal("hide");location.reload()},1e3)})}showAlert(n){const t=$("#alertModal");t.find("#alertContent").html(n);t.modal("show")}underMaintenance(){confirm("Are you sure you want to set Under Maintenance schedule?")&&$.ajax({method:"POST",url:"/status/um",dataType:"json",data:$("#umForm").serialize()}).done(function(n){n&&(alert("Under Maintenance!"),$("#umModal").modal("hide"))})}showUnderMaintenanceForm(){$.ajax({method:"GET",url:"/status/um"}).done(function(n){n&&($("#um").html(n),$("#umModal").modal("show"))})}}var gameStatus=new GameStatus;stickHeader.stick(".inner-content","table#status-tbl",120,-20);